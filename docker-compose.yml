version: "3.9"
services:
  contracts:
    container_name: ethdam-contracts
    build:
      context: contracts
      dockerfile: Dockerfile
    ports:
      - "8545:8545"
    volumes:
      - "./contracts:/app"

  contract_jobs:
    container_name: ethdam-contracts-jobs
    depends_on:
      - contracts
    build:
      context: contracts
      dockerfile: Dockerfile
    volumes:
      - "./contracts:/app"
    command: "sleep 5 && yarn run hardhat run scripts/deploy-test-context.ts --network localhost"

  mongo:
    image: mongo:4.2.24
    ports:
      - "27017:27017"
    volumes:
      - /data/db
    command: mongod

  server:
    build: ./server
    volumes:
      - ./server:/app
    ports:
      - "3000:3000"
  autofi-ui:
    build: ./autofi-ui
    volumes:
      - ./autofi:/app
    ports:
      - "5173:5173"
    environment:
      - FACTORY=0xFa64f316e627aD8360de2476aF0dD9250018CFc5

# bs              | [Entrypoint]: 0xFf6974a7732d12499246056f3aCeF80051bB48f5
# ethdam-contracts-jobs              | [Factory]: 0xFa64f316e627aD8360de2476aF0dD9250018CFc5 // 0xFa64f316e627aD8360de2476aF0dD9250018CFc5

# ethdam-contracts-jobs              | [DCAWallet]: 0xBAd3D6f2D86596cE67012A061719E13BaF39772e